(function(){"use strict";var t={3642:function(t,e,i){var s=i(9242),a=i(3396),o=i(7139);const n={class:"main"},l={key:0,class:"editor"},h={class:"panel"},r=(0,a._)("small",null,"Tool",-1),c={class:"btn-tools"},d=["onClick"],p=(0,a._)("small",null,"Actions",-1),u={class:"btn-tools"},v=(0,a._)("label",{for:"upload-sdp",class:"button"},"Upload sdp",-1),g=["disabled"],y=["disabled"],f={class:"options mb"},m={class:"mb"},w=(0,a._)("small",null,"Stroke color",-1),k={class:"btn-colors"},b=["onClick"],x={class:"mb"},L=(0,a._)("small",null,"Fill color",-1),C={class:"btn-colors"},_=["onClick"],S={key:0,class:"mb"},M=(0,a._)("small",null,"Last used colors",-1),D={class:"btn-colors"},T=["onClick"],R={key:1,class:"mb"},W=(0,a._)("small",null,"Line width",-1),$=(0,a.uE)('<option value="1">1 px</option><option value="2">2 px</option><option value="3">3 px</option><option value="4">4 px</option><option value="5">5 px</option><option value="6">6 px</option><option value="7">7 px</option><option value="8">8 px</option><option value="9">9 px</option><option value="10">10 px</option>',10),H=[$],z={key:2,class:"mt mb"},U=(0,a.Uk)(" Fill shapes "),j={key:3,class:"mt mb"},I={class:"mt mb"},P=(0,a._)("small",null,"Outer radius",-1),E={class:"mt mb"},F=(0,a._)("small",null,"Inner radius",-1),O={key:5,class:"mt"},K={class:"btn-images"},Y=["onClick"],q=["src"],Z=(0,a._)("label",{for:"custom-pattern"},"Custom pattern",-1),V={class:"layers"},A={class:"mb"},B={class:"layers-list"},J=["onClick"],N=(0,a._)("br",null,null,-1),G={key:0},Q=["onClick"],X=(0,a._)("br",null,null,-1),tt=["onClick"],et=(0,a._)("br",null,null,-1),it=["onClick"],st={class:"area"},at=["id","width","height"],ot=["onMousedown"],nt=["width","height"],lt={key:1,class:"welcome"},ht={class:"mb"},rt=(0,a._)("label",null,"Canvas width",-1),ct={class:"mb"},dt=(0,a._)("label",null,"Canvas height",-1),pt={class:"mb"},ut=(0,a._)("label",null,"Canvas background",-1),vt=(0,a._)("button",{class:"block"},"Create",-1);function gt(t,e,i,$,gt,yt){return(0,a.wg)(),(0,a.iD)("div",n,[gt.initialized?((0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",h,[(0,a._)("div",null,[r,(0,a._)("div",c,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(["brush","rectangle","ellipse","polygon","stamp","star","fill"],(t=>(0,a._)("button",{key:t,onClick:e=>gt.options.activeTool=t,class:(0,o.C_)({active:this.options.activeTool===t})},(0,o.zw)(t.slice(0,1).toUpperCase())+(0,o.zw)(t.slice(1)),11,d))),64))])]),(0,a._)("div",null,[p,(0,a._)("div",u,[(0,a._)("button",{onClick:e[0]||(e[0]=(...t)=>yt.saveJpeg&&yt.saveJpeg(...t))},"Save to jpeg"),(0,a._)("button",{onClick:e[1]||(e[1]=(...t)=>yt.saveSdp&&yt.saveSdp(...t))},"Save to sdp"),v,(0,a._)("input",{type:"file",id:"upload-sdp",style:{display:"none"},onChange:e[2]||(e[2]=(...t)=>yt.uploadSdp&&yt.uploadSdp(...t))},null,32),(0,a._)("button",{onClick:e[3]||(e[3]=t=>yt.jumpToSnapshot(gt.state.currentSnapshot-1)),disabled:!gt.state.currentSnapshot||gt.state.currentSnapshot<gt.snapshots.length-3},"Undo",8,g),(0,a._)("button",{onClick:e[4]||(e[4]=t=>yt.jumpToSnapshot(gt.state.currentSnapshot+1)),disabled:gt.state.currentSnapshot===gt.snapshots.length-1},"Redo",8,y)])])]),(0,a._)("div",null,[(0,a._)("div",f,[(0,a._)("div",m,[w,(0,a._)("div",k,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(["#ff0000","#00ff00","#0000ff","#ffff00","#800080"],((t,e)=>(0,a._)("button",{key:e,style:(0,o.j5)({background:t}),onClick:e=>{gt.options.strokeColor=t,yt.rememberColor(t)},class:(0,o.C_)({active:this.options.strokeColor===t})},null,14,b))),64))]),(0,a.wy)((0,a._)("input",{type:"color","onUpdate:modelValue":e[5]||(e[5]=t=>gt.options.strokeColor=t),onChange:e[6]||(e[6]=t=>yt.rememberColor(t.target.value))},null,544),[[s.nr,gt.options.strokeColor]])]),(0,a._)("div",x,[L,(0,a._)("div",C,[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(["#ff0000","#00ff00","#0000ff","#ffff00","#800080"],((t,e)=>(0,a._)("button",{key:e,style:(0,o.j5)({background:t}),onClick:e=>{gt.options.fillColor=t,yt.rememberColor(t)},class:(0,o.C_)({active:this.options.fillColor===t})},null,14,_))),64))]),(0,a.wy)((0,a._)("input",{type:"color","onUpdate:modelValue":e[7]||(e[7]=t=>gt.options.fillColor=t),onChange:e[8]||(e[8]=t=>yt.rememberColor(t.target.value))},null,544),[[s.nr,gt.options.fillColor]])]),gt.lastUsedColors.length?((0,a.wg)(),(0,a.iD)("div",S,[M,(0,a._)("div",D,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(gt.lastUsedColors,((t,e)=>((0,a.wg)(),(0,a.iD)("button",{key:e,style:(0,o.j5)({background:t}),onClick:e=>gt.options.strokeColor=t},null,12,T)))),128))])])):(0,a.kq)("",!0),["brush","rectangle","ellipse","polygon","star","stamp"].includes(gt.options.activeTool)?((0,a.wg)(),(0,a.iD)("div",R,[W,(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>gt.options.lineWidth=t)},H,512),[[s.bM,gt.options.lineWidth]])])):(0,a.kq)("",!0),["rectangle","ellipse","polygon","star"].includes(gt.options.activeTool)?((0,a.wg)(),(0,a.iD)("div",z,[(0,a._)("label",null,[(0,a.wy)((0,a._)("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=t=>gt.options.fillShape=t)},null,512),[[s.e8,gt.options.fillShape]]),U])])):(0,a.kq)("",!0),["polygon","star"].includes(gt.options.activeTool)?((0,a.wg)(),(0,a.iD)("div",j,[(0,a._)("small",null,(0,o.zw)("star"===gt.options.activeTool?"Spikes":"Sides")+" count",1),(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":e[11]||(e[11]=t=>gt.options.sidesCount=t),min:"3"},null,512),[[s.nr,gt.options.sidesCount]])])):(0,a.kq)("",!0),"star"===gt.options.activeTool?((0,a.wg)(),(0,a.iD)(a.HY,{key:4},[(0,a._)("div",I,[P,(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=t=>gt.options.outerRadius=t)},null,512),[[s.nr,gt.options.outerRadius]])]),(0,a._)("div",E,[F,(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":e[13]||(e[13]=t=>gt.options.innerRadius=t)},null,512),[[s.nr,gt.options.innerRadius]])])],64)):(0,a.kq)("",!0),"stamp"===gt.options.activeTool?((0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",K,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(gt.stamps,(t=>((0,a.wg)(),(0,a.iD)("button",{key:t.src,onClick:e=>gt.options.activeStamp=t.src,class:(0,o.C_)({active:gt.options.activeStamp===t.src})},[(0,a._)("img",{src:t.src,alt:""},null,8,q)],10,Y)))),128))]),Z,(0,a._)("input",{id:"custom-pattern",type:"file",accept:"image/*",onChange:e[14]||(e[14]=(...t)=>yt.addImage&&yt.addImage(...t))},null,32)])):(0,a.kq)("",!0)]),(0,a._)("div",V,[(0,a._)("div",A,[(0,a._)("button",{onClick:e[15]||(e[15]=t=>{yt.addLayer(),yt.makeSnapshot()})},"Add layer")]),(0,a._)("div",B,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(gt.layers,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,o.C_)(["layer mb",{active:gt.activeLayer.id===t.id}]),key:t.id},[(0,a._)("a",{href:"#",class:"unset",onClick:(0,s.iM)((e=>gt.activeLayer=t),["prevent"])},[(0,a.Uk)((0,o.zw)(t.name),1),N,(0,a._)("i",null,"("+(0,o.zw)(t.vector?"Vector":"Bitmap")+")",1)],8,J),gt.layers.length>1&&!t.background?((0,a.wg)(),(0,a.iD)("div",G,[e>1?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("a",{href:"#",onClick:(0,s.iM)((t=>gt.layers.splice(e-1,2,gt.layers[e],gt.layers[e-1])),["prevent"])},"Down",8,Q),X],64)):(0,a.kq)("",!0),gt.layers.length>e+1?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a._)("a",{href:"#",onClick:(0,s.iM)((t=>gt.layers.splice(e,2,gt.layers[e+1],gt.layers[e])),["prevent"])},"Up",8,tt),et],64)):(0,a.kq)("",!0),(0,a._)("a",{href:"#",onClick:(0,s.iM)((t=>yt.deleteLayer(e)),["prevent"])},"Delete",8,it)])):(0,a.kq)("",!0)],2)))),128))])])]),(0,a._)("div",null,[(0,a._)("div",st,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(gt.layers,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"layer-canvas",key:t.id,style:(0,o.j5)({top:`${t.top}px`,left:`${t.left}px`})},[(0,a._)("canvas",{id:`canvas-${t.id}`,width:t.width,height:t.height,class:(0,o.C_)({active:!t.background&&t.id===gt.activeLayer.id})},null,10,at),t.id!==gt.activeLayer.id||t.background?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(["top-left","top-right","bottom-left","bottom-right"],(t=>(0,a._)("div",{class:(0,o.C_)(["vertice",t]),key:t,onMousedown:e=>gt.state.resizing=t,onMousemove:e[16]||(e[16]=(...t)=>yt.mousemove&&yt.mousemove(...t))},null,42,ot))),64))],4)))),128)),(0,a._)("canvas",{id:"work-canvas",width:gt.options.canvasWidth,height:gt.options.canvasHeight,onMousedown:e[17]||(e[17]=(...t)=>yt.mousedown&&yt.mousedown(...t)),onMousemove:e[18]||(e[18]=(...t)=>yt.mousemove&&yt.mousemove(...t)),style:(0,o.j5)({cursor:yt.cursor})},null,44,nt),gt.activeLayer.background||gt.activeLayer.width<gt.options.canvasWidth||gt.activeLayer.height<gt.options.canvasHeight?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"vertice bottom-right",onMousedown:e[19]||(e[19]=t=>gt.state.resizing="canvas"),onMousemove:e[20]||(e[20]=(...t)=>yt.mousemove&&yt.mousemove(...t))},null,32)):(0,a.kq)("",!0)])])])):((0,a.wg)(),(0,a.iD)("div",lt,[(0,a._)("form",{action:"#",onSubmit:e[24]||(e[24]=(0,s.iM)(((...t)=>yt.init&&yt.init(...t)),["prevent"]))},[(0,a._)("p",ht,[rt,(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":e[21]||(e[21]=t=>gt.options.canvasWidth=t),class:"block"},null,512),[[s.nr,gt.options.canvasWidth]])]),(0,a._)("p",ct,[dt,(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":e[22]||(e[22]=t=>gt.options.canvasHeight=t),class:"block"},null,512),[[s.nr,gt.options.canvasHeight]])]),(0,a._)("p",pt,[ut,(0,a.wy)((0,a._)("input",{type:"color","onUpdate:modelValue":e[23]||(e[23]=t=>gt.options.fillColor=t),class:"block"},null,512),[[s.nr,gt.options.fillColor]])]),vt],32)]))])}var yt={name:"App",data(){return{layers:[],activeLayer:{shapes:[]},options:{activeTool:"brush",activeStamp:"img/logo.png",lineWidth:1,strokeColor:"#000000",fillColor:"#FFFFFF",fillShape:!0,sidesCount:6,canvasWidth:800,canvasHeight:600,outerRadius:100,innerRadius:30},state:{selectionStart:{x:0,y:0},drawing:!1,moving:!1,resizing:null,currentSnapshot:-1},lastUsedColors:[],initialized:!1,snapshots:[],stamps:[{src:"img/logo.png"},{src:"img/shape-1.jpg"},{src:"img/shape-2.jpg"},{src:"img/shape-3.jpg"},{src:"img/shape-4.jpg"}]}},watch:{options:{deep:!0,handler:function(){this.options.innerRadius>this.options.outerRadius&&(this.options.innerRadius=this.options.outerRadius)}}},computed:{cursor:function(){return"stamp"===this.options.activeTool?`url(${this.options.activeStamp}), crosshair`:this.state.moving?"grab":this.state.drawing?"crosshair":"default"}},methods:{addLayer:function(t=!1){this.layers.push({id:Date.now(),name:`Layer ${this.layers.length+1}`,visible:!0,width:this.options.canvasWidth,height:this.options.canvasHeight,top:0,left:0,shapes:[],vector:t}),this.activeLayer=this.layers[this.layers.length-1],this.$nextTick((()=>{this.initializeCanvas(this.activeLayer)}))},initializeCanvas:function(t){t.el=document.getElementById(`canvas-${t.id}`),t.ctx=t.el.getContext("2d"),this.$nextTick((()=>this.drawShapes(t)))},init:function(){this.initialized=!0,this.addLayer(),this.$nextTick((()=>{this.activeLayer.background=this.options.fillColor,this.activeLayer.name+=" - Background",this.drawShapes(this.activeLayer),this.rememberColor(this.options.fillColor),this.makeSnapshot()}))},makeSnapshot:function(){this.snapshots=this.snapshots.slice(0,this.state.currentSnapshot+1),this.snapshots.push({canvas:{width:this.options.canvasWidth,height:this.options.canvasHeight},layers:[...this.layers].map((t=>({background:t.background,id:t.id,height:t.height,width:t.width,top:t.top,left:t.left,name:t.name,visible:t.visible,shapes:[...t.shapes]}))),timestamp:Date.now()}),this.state.currentSnapshot++},getRealPosition:function(t){let e=document.getElementById("work-canvas").getBoundingClientRect();return{x:Math.min(t.x-e.x,this.options.canvasWidth),y:Math.min(t.y-e.y,this.options.canvasHeight)}},rememberColor:function(t){this.lastUsedColors.unshift(t),this.lastUsedColors=this.lastUsedColors.filter(((t,e,i)=>i.indexOf(t)===e)).slice(0,10)},deleteLayer:function(t){this.layers.splice(t,1),this.layers.find((t=>t.id===this.activeLayer.id))||(this.activeLayer=this.layers[t+1]||this.layers[t-1]),this.makeSnapshot()},mousedown:async function(t){let{x:e,y:i}=this.getRealPosition(t);if(this.state.selectionStart={x:e,y:i},t.ctrlKey)return void(this.state.moving=!0);this.state.drawing=!0;let s={tool:this.options.activeTool};switch(this.options.activeTool){case"brush":e-=this.activeLayer.left,i-=this.activeLayer.top,s.dots=[{x:this.activeLayer.width?e/this.activeLayer.width:0,y:this.activeLayer.height?i/this.activeLayer.height:0}];break;case"ellipse":case"rectangle":case"polygon":case"star":this.addLayer(!0),await this.$nextTick(),this.activeLayer.name+=` - ${this.options.activeTool}`,this.activeLayer.left=e,this.activeLayer.top=i,this.activeLayer.width=0,this.activeLayer.height=0;break;case"stamp":s.stamp=this.options.activeStamp,e-=this.activeLayer.left,i-=this.activeLayer.top,s.dots=[{x:this.activeLayer.width?e/this.activeLayer.width:0,y:this.activeLayer.height?i/this.activeLayer.height:0}];break;case"fill":s.x=this.activeLayer.width?e/this.activeLayer.width:0,s.y=this.activeLayer.height?i/this.activeLayer.height:0;break;default:break}s.lineWidth=this.options.lineWidth,s.strokeStyle=this.options.strokeColor,s.fillStyle=this.options.fillColor,s.fillShape=this.options.fillShape,s.sidesCount=this.options.sidesCount,s.radiusRatio=this.options.outerRadius?this.options.innerRadius/this.options.outerRadius:0,this.activeLayer.ctx.lineWidth=this.options.lineWidth,this.activeLayer.ctx.strokeStyle=this.options.strokeColor,this.activeLayer.ctx.fillStyle=this.options.fillColor,this.activeLayer.shapes.push(s),await this.drawShapes(this.activeLayer)},mousemove:function(t){let{x:e,y:i}=this.getRealPosition(t),s=this.state.selectionStart.x,a=this.state.selectionStart.y;if(this.state.drawing){let o=this.activeLayer.shapes[this.activeLayer.shapes.length-1];switch(this.options.activeTool){case"brush":e-=this.activeLayer.left,i-=this.activeLayer.top,t.shiftKey?Math.abs(s-e)<Math.abs(a-i)?e=s:i=a:this.state.selectionStart={x:e,y:i},o.dots.push({x:this.activeLayer.width?e/this.activeLayer.width:0,y:this.activeLayer.height?i/this.activeLayer.height:0});break;case"rectangle":case"ellipse":case"polygon":case"star":this.activeLayer.width=Math.abs(e-s),this.activeLayer.height=t.shiftKey?this.activeLayer.width:Math.abs(i-a),this.activeLayer.top=Math.min(a,i),this.activeLayer.left=Math.min(s,e);break;case"stamp":e-=this.activeLayer.left,i-=this.activeLayer.top,o.dots.push({x:this.activeLayer.width?e/this.activeLayer.width:0,y:this.activeLayer.height?i/this.activeLayer.height:0});break;default:break}this.drawShapes(this.activeLayer)}this.state.resizing&&("canvas"===this.state.resizing?this.scaleCanvas(t):this.scaleLayer(t)),this.state.moving&&(this.activeLayer.top+=i-a,this.activeLayer.left+=e-s,this.state.selectionStart={x:e,y:i})},mouseup:function(){let t=this.state.drawing||this.state.resizing||this.state.moving;this.state.drawing=!1,this.state.moving=!1,this.state.resizing=null,t&&this.$nextTick((()=>this.makeSnapshot()))},scaleLayer:function(t){let e=this.activeLayer.left,i=this.activeLayer.left+this.activeLayer.width,s=this.activeLayer.top,a=this.activeLayer.top+this.activeLayer.height,{x:o,y:n}=this.getRealPosition(t),l=this.activeLayer.height?this.activeLayer.width/this.activeLayer.height:0;switch(this.state.resizing){case"top-left":e=Math.min(i,o),s=Math.min(a,n);break;case"top-right":i=Math.max(e,o),s=Math.min(a,n);break;case"bottom-left":e=Math.min(i,o),a=Math.max(s,n);break;case"bottom-right":i=Math.max(e,o),a=Math.max(s,n);break;default:break}this.activeLayer.width=i-e,this.activeLayer.height=t.shiftKey?l?this.activeLayer.width/l:0:a-s,this.activeLayer.top="top-left"===this.state.resizing||"top-right"===this.state.resizing?a-this.activeLayer.height:s,this.activeLayer.left="top-left"===this.state.resizing||"top-right"===this.state.resizing?i-this.activeLayer.width:e,this.$nextTick((()=>this.drawShapes(this.activeLayer)))},scaleCanvas:function(t){let{x:e,y:i}=this.getRealPosition(t),s=this.options.canvasWidth,a=this.options.canvasHeight,o=this.options.canvasHeight?this.options.canvasWidth/this.options.canvasHeight:0;this.options.canvasWidth=e,this.options.canvasHeight=t.shiftKey?o?this.options.canvasWidth/o:0:i,this.layers.forEach((t=>{t.top=t.top/Math.max(a,1)*this.options.canvasHeight,t.left=t.left/Math.max(s,1)*this.options.canvasWidth,t.height=t.height/Math.max(a,1)*this.options.canvasHeight,t.width=t.width/Math.max(s,1)*this.options.canvasWidth,this.$nextTick((()=>this.drawShapes(t)))}))},drawShapes:function(t){t.background&&(t.ctx.fillStyle=t.background,t.ctx.fillRect(0,0,t.width,t.height)),t.shapes.forEach((e=>{this.$nextTick((()=>{if(t.ctx.lineWidth=e.lineWidth,t.ctx.strokeStyle=e.strokeStyle,t.ctx.fillStyle=e.fillStyle,"brush"===e.tool)e.dots[0]&&(t.ctx.moveTo(e.dots[0].x*t.width,e.dots[0].y*t.height),t.ctx.beginPath()),e.dots.slice(1).forEach((e=>{t.ctx.lineTo(e.x*t.width,e.y*t.height),t.ctx.stroke()}));else if("rectangle"===e.tool)t.ctx.clearRect(0,0,t.width,t.height),t.ctx.rect(Math.floor(e.lineWidth/2),Math.floor(e.lineWidth/2),t.width-e.lineWidth,t.height-e.lineWidth),e.fillShape&&t.ctx.fill(),t.ctx.stroke();else if("ellipse"===e.tool)t.ctx.clearRect(0,0,t.width,t.height),t.ctx.beginPath(),t.ctx.ellipse(t.width/2,t.height/2,Math.abs(t.width/2-e.lineWidth/2),Math.abs(t.height/2-e.lineWidth/2),0,0,2*Math.PI),e.fillShape&&t.ctx.fill(),t.ctx.stroke();else if("polygon"===e.tool){if(t.ctx.clearRect(0,0,t.width,t.height),e.sidesCount>2){t.ctx.beginPath();let i=2*Math.PI/e.sidesCount,s=t.height/2,a=t.width/2;t.ctx.translate(a,s),t.ctx.moveTo(a,0);for(let o=1;o<e.sidesCount;o++)t.ctx.lineTo(a*Math.cos(i*o),s*Math.sin(i*o));t.ctx.closePath(),e.fillShape&&t.ctx.fill(),t.ctx.stroke()}}else if("star"===e.tool){if(t.ctx.clearRect(0,0,t.width,t.height),e.sidesCount>2){let i=2*e.sidesCount;t.ctx.beginPath();let s=2*Math.PI/i,a=t.height/2,o=t.width/2;t.ctx.translate(o,a),t.ctx.moveTo(o,0);for(let n=1;n<i;n++)t.ctx.lineTo((n%2?o*e.radiusRatio:o)*Math.cos(s*n),(n%2?a*e.radiusRatio:a)*Math.sin(s*n));t.ctx.closePath(),e.fillShape&&t.ctx.fill(),t.ctx.stroke()}}else if("stamp"===e.tool){let i=this.stamps.find((t=>t.src===e.stamp));i.image&&this.renderImage(t,i.image,e.dots,e.lineWidth);let s=new Image;s.onload=()=>{this.renderImage(t,s,e.dots,e.lineWidth),i.image=s},s.src=e.stamp}}))}))},renderImage:function(t,e,i,s){i.forEach((i=>{t.ctx.drawImage(e,0,0,e.width,e.height,t.width*i.x,t.height*i.y,20*s,20*s)}))},leadZero:function(t){return t<10?`0${t}`:t},saveJpeg:function(){let t=document.createElement("canvas");t.width=this.options.canvasWidth,t.height=this.options.canvasHeight;let e=t.getContext("2d");this.layers.forEach((t=>{t.width&&t.height&&e.drawImage(t.el,0,0,t.width,t.height,t.left,t.top,t.width,t.height)}));let i=t.toDataURL("image/jpeg"),s=document.createElement("a");s.href=i,s.download=`${(new Date).getFullYear()}${this.leadZero((new Date).getMonth())}${this.leadZero((new Date).getDate())}_${this.leadZero((new Date).getHours())}${this.leadZero((new Date).getMinutes())}${this.leadZero((new Date).getSeconds())}.jpg`,s.click()},saveSdp:function(){let t=document.createElement("a");t.href="data:application/json,"+encodeURIComponent(JSON.stringify({options:this.options,layers:this.layers,stamps:this.stamps.map((t=>({src:t.src})))})),t.download=`${(new Date).getFullYear()}${this.leadZero((new Date).getMonth())}${this.leadZero((new Date).getDate())}_${this.leadZero((new Date).getHours())}${this.leadZero((new Date).getMinutes())}${this.leadZero((new Date).getSeconds())}.sdp`,t.click()},uploadSdp:function(t){if(t.target.files&&t.target.files[0]){const e=new FileReader;e.onload=t=>{let e=JSON.parse(t.target.result);e.options&&(this.options={...e.options}),e.layers&&(this.layers=[...e.layers]),e.stamps&&(this.stamps=[...e.stamps]),this.$nextTick((()=>{this.layers.forEach((t=>this.initializeCanvas(t))),this.makeSnapshot()}))},e.readAsText(t.target.files[0])}},jumpToSnapshot:function(t){this.state.currentSnapshot=t,this.options.canvasWidth=this.snapshots[t].canvas.width,this.options.canvasHeight=this.snapshots[t].canvas.height,this.layers=[],this.$nextTick((()=>{this.layers=[...this.snapshots[t].layers],this.layers.find((t=>t.id===this.activeLayer.id))||(this.activeLayer=this.layers[this.layers.length-1]),this.$nextTick((()=>this.layers.forEach((t=>this.initializeCanvas(t)))))}))},addImage:function(t){if(t.target.files&&t.target.files[0]){const e=new FileReader;e.onload=t=>{this.stamps.push({src:t.target.result}),this.options.activeStamp=t.target.result},e.readAsDataURL(t.target.files[0])}}},mounted(){this.init(),window.onmouseup=this.mouseup}},ft=i(89);const mt=(0,ft.Z)(yt,[["render",gt]]);var wt=mt,kt=i(5431);(0,kt.z)("service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),(0,s.ri)(wt).mount("#app")}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}i.m=t,function(){var t=[];i.O=function(e,s,a,o){if(!s){var n=1/0;for(c=0;c<t.length;c++){s=t[c][0],a=t[c][1],o=t[c][2];for(var l=!0,h=0;h<s.length;h++)(!1&o||n>=o)&&Object.keys(i.O).every((function(t){return i.O[t](s[h])}))?s.splice(h--,1):(l=!1,o<n&&(n=o));if(l){t.splice(c--,1);var r=a();void 0!==r&&(e=r)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[s,a,o]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,o,n=s[0],l=s[1],h=s[2],r=0;if(n.some((function(e){return 0!==t[e]}))){for(a in l)i.o(l,a)&&(i.m[a]=l[a]);if(h)var c=h(i)}for(e&&e(s);r<n.length;r++)o=n[r],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(c)},s=self["webpackChunkcanvas_editor"]=self["webpackChunkcanvas_editor"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(3642)}));s=i.O(s)})();
//# sourceMappingURL=app.d1c6242e.js.map